language: java
sudo: require

jdk:
  - oraclejdk8

cache:
  directories:
    - ${HOME}/.m2

env:
  global:
  matrix:
    - MODULE='single' CATEGORY="com.amazon.titan.testcategory.SingleItemTestCategory"
    - MODULE='multiple' CATEGORY="com.amazon.titan.testcategory.MultipleItemTestCategory"
    - MODULE='SingleMultiWriteStoreTestCategory' CATEGORY="com.amazon.titan.testcategory.SingleDynamoDBMultiWriteStoreTestCategory"
    - MODULE='MultiMultiWriteStoreTestCategory' CATEGORY="com.amazon.titan.testcategory.MultiDynamoDBMultiWriteStoreTestCategory"
    - MODULE='SingleOLAPTest' CATEGORY="com.amazon.titan.testcategory.SingleDynamoDBOLAPTestCategory"
    - MODULE='MultiOLAPTest' CATEGORY="com.amazon.titan.testcategory.MultiDynamoDBOLAPTestCategory"
    - MODULE='SingleStoreTest' CATEGORY="com.amazon.titan.testcategory.SingleDynamoDBStoreTestCategory"
    - MODULE='Single-testConcurrentGetSlice' CATEGORY="com.amazon.titan.testcategory.IsolateSingleConcurrentGetSlice"
    - MODULE='Single-testConcurrentGetSliceAndMutate' CATEGORY="com.amazon.titan.testcategory.IsolateSingleConcurrentGetSliceAndMutate"
    - MODULE='MultiStoreTest' CATEGORY="com.amazon.titan.testcategory.MultiDynamoDBStoreTestCategory"
    - MODULE='Multi-testConcurrentGetSlice' CATEGORY="com.amazon.titan.testcategory.IsolateMultiConcurrentGetSlice"
    - MODULE='Multi-testConcurrentGetSliceAndMutate' CATEGORY="com.amazon.titan.testcategory.IsolateMultiConcurrentGetSliceAndMutate"
    - MODULE='SingleGraphTest' CATEGORY="com.amazon.titan.testcategory.SingleDynamoDBGraphTestCategory"
    - MODULE='MultiGraphTest' CATEGORY="com.amazon.titan.testcategory.MultiDynamoDBGraphTestCategory"
    - MODULE='Multi-testLargeJointIndexRetrieval' CATEGORY="com.amazon.titan.testcategory.IsolateMultiLargeJointIndexRetrieval"
    - MODULE='Multi-testVertexCentricQuery' CATEGORY="com.amazon.titan.testcategory.IsolateMultiVertexCentricQuery"
    - MODULE='Multi-testEdgesExceedCacheSize' CATEGORY="com.amazon.titan.testcategory.IsolateMultiEdgesExceedCacheSize"

addons:
  apt:
    packages:
      - oracle-java8-installer

branches:
  only:
    - 1.0.0
    - locking
    - ttl
    - travis

script:
  - mvn install -P integration-tests -Dgroups=${CATEGORY} -Dinclude.category="**/*.java"
  - bash src/test/resources/install-gremlin-server.sh

notifications:
  email:
    - amcp@amazon.co.jp
